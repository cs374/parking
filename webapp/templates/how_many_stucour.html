<html>

<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <style>
        p {
            margin: 0;
        }

        #days {
            display: flex;
            flex-direction: row;
        }

        h1 {
            margin-bottom: 0;
        }

        #sub {
            margin: 10px 0;
            font-style: italic;
        }
    </style>
</head>

<body>
    <h1>Finding Student Enrollment</h1>
    <p id="sub">Results only show class times with more than 50 people and more than 5 courses.</p>

    <form>
        <p>Select a Term:</p>
        <input type="radio" id="1211" name="term" value="1211">
        <label for="1211">Spring 2021</label><br>
        <input type="radio" id="1218" name="term" value="1218">
        <label for="1218">Fall 2021</label><br>

        <br>

        <p>Select a Day/Days:</p>
        <div id="days">
            <input type="checkbox" name="M" id="M">
            <label for="M">Monday</label><br>
            <input type="checkbox" name="TU" id="TU">
            <label for="TU">Tuesday</label><br>
            <input type="checkbox" name="W" id="W">
            <label for="W">Wednesday</label><br>
            <input type="checkbox" name="TH" id="Th">
            <label for="Th">Thursday</label><br>
            <input type="checkbox" name="F" id="F">
            <label for="F">Friday</label><br>
        </div>

        <br>

        <p><input type="submit"></p>
    </form>

    {% for message in get_flashed_messages() %}
    <p style="color:red">{{ message }}</p>
    {% endfor %}

    {%if cur%}
    <div id="chart_div" style="width: 1000px; height: 500px"></div>
    <script>
        google.charts.load('current', { 'packages': ['corechart', 'bar'] });
        google.charts.setOnLoadCallback(drawStuff);

        function drawStuff() {

            var button = document.getElementById('change-chart');
            var chartDiv = document.getElementById('chart_div');

            var data = google.visualization.arrayToDataTable([
                ["Time", "num_students", "num_courses"],
                {% for row in cur %}
        ["{{ row[0] }}", {{ row[1] }}, {{ row[2] }}],
            {% endfor %}
            ]);

        var materialOptions = {
            width: 900,
            chart: {
                title: 'Student numbers and Course Offerings on {{ day }} in {{ term }}',
                subtitle: 'Note: a student in one time could be a student in another time.'
            },
            series: {
                0: { axis: 'students' }, // Bind series 0 to an axis named 'distance'.
                1: { axis: 'courses' } // Bind series 1 to an axis named 'brightness'.
            },
            axes: {
                y: {
                    students: { label: 'Students' }, // Left y-axis.
                    courses: { side: 'right', label: 'Courses' } // Right y-axis.
                }
            }
        };

        var classicOptions = {
            width: 900,
            series: {
                0: { targetAxisIndex: 0 },
                1: { targetAxisIndex: 1 }
            },
            vAxes: {
                // Adds titles to each axis.
                0: { title: 'Students' },
                1: { title: 'Courses' }
            }
        };

        function drawMaterialChart() {
            var materialChart = new google.charts.Bar(chartDiv);
            materialChart.draw(data, google.charts.Bar.convertOptions(materialOptions));
            button.innerText = 'Change to Classic';
            button.onclick = drawClassicChart;
        }

        function drawClassicChart() {
            var classicChart = new google.visualization.ColumnChart(chartDiv);
            classicChart.draw(data, classicOptions);
            button.innerText = 'Change to Material';
            button.onclick = drawMaterialChart;
        }

        drawMaterialChart();
        };
    </script>
    {%endif%}
</body>

</html>
<html>

<head>
    <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    <link rel="stylesheet" href="{{ url_for('static', filename='query_pages.css')}}" />
    <link rel="stylesheet" href="static/style.css"/>
    <link rel="icon" type="image/png" sizes="32x32" href="static/icon.png"/>
</head>

<body>
    <!-- NAV BAR -->
    {% with home=False, garages=True, students=False,
    occupied=False, faculty=False, visitors=False %}
    {% include 'nav.html' %}
    {% endwith %}

    <br>
    <h1 class="center">Garage Occupancy</h1>

    <p class="center" style="margin-left: 10%; margin-right: 10%; font-size: 20px;">
        This query is designed to show how the number of occupied spaces for a specific garage fluctuates
        on a specific date. Users will need to select which garage they are interested in and the date
        they would like to view from the input boxes below.
    </p>

    {% if cur1 %}
    <form class="center">
        <h5>Select a Garage:</h5>
        {% for garage in cur1 %}
        <input type="radio" id="Z{{ garage[0] }}" name="garage" value="{{ garage[0] }}" checked>
        <label for="Z{{ garage[0] }}">{{ garage[1] }}: {{ garage[2] }}</label><br>
        {% endfor %}

        <br>
        <h5>Select a Date:</h5>
        <input class="text-box" type="date" name="date" value="{{ date }}" min="2021-01-01" max="2021-11-04">
        </div>
        <br /> <br />
        <p><input class="submit" type="submit"></p>
    </form>
    {% endif %}

    <!-- Saves which button was selected after submitting -->
    <script>
        document.getElementById("Z{{ garage }}").checked = true;
    </script>

    {% for message in get_flashed_messages() %}
    <p style="color:red">{{ message }}</p>
    {% endfor %}

    {% if cur2 %}
    <div id="curve_chart" style="width: 900px; height: 500px"></div>
    <script>
        google.charts.load('current', { 'packages': ['corechart'] });
        google.charts.setOnLoadCallback(drawChart);

        function drawChart() {
            var data = google.visualization.arrayToDataTable([
                ['Time', 'Occupancy'],
                {% for row in cur2 %}
        ["{{ row[0] }}", {{ row[1]}}],
            {% endfor %}
            ]);

        var options = {
            title: '{{ strGarage }} Occupancy for {{ date }}',
            curveType: 'function',
            legend: { position: 'bottom' },
            vAxis: {
                title: "Parking Spaces"
            }
        };

        var chart = new google.visualization.LineChart(document.getElementById('curve_chart'));

        chart.draw(data, options);
        }
    </script>
    {% endif %}
</body>

</html>